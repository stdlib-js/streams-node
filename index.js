// Copyright (c) 2024 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("stream"),require("process"),require("buffer")):"function"==typeof define&&define.amd?define(["stream","process","buffer"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).streams=t(e.require$$0$2,e.require$$0$1,e.require$$0$3)}(this,(function(e,t,r){"use strict";var n="function"==typeof Object.defineProperty?Object.defineProperty:null;var i=Object.defineProperty;function o(e){return"number"==typeof e}function a(e){var t,r="";for(t=0;t<e;t++)r+="0";return r}function s(e,t,r){var n=!1,i=t-e.length;return i<0||(function(e){return"-"===e[0]}(e)&&(n=!0,e=e.substr(1)),e=r?e+a(i):a(i)+e,n&&(e="-"+e)),e}var u=String.prototype.toLowerCase,l=String.prototype.toUpperCase;function c(e){var t,r,n;switch(e.specifier){case"b":t=2;break;case"o":t=8;break;case"x":case"X":t=16;break;default:t=10}if(r=e.arg,n=parseInt(r,10),!isFinite(n)){if(!o(r))throw new Error("invalid integer. Value: "+r);n=0}return n<0&&("u"===e.specifier||10!==t)&&(n=4294967295+n+1),n<0?(r=(-n).toString(t),e.precision&&(r=s(r,e.precision,e.padRight)),r="-"+r):(r=n.toString(t),n||e.precision?e.precision&&(r=s(r,e.precision,e.padRight)):r="",e.sign&&(r=e.sign+r)),16===t&&(e.alternate&&(r="0x"+r),r=e.specifier===l.call(e.specifier)?l.call(r):u.call(r)),8===t&&e.alternate&&"0"!==r.charAt(0)&&(r="0"+r),r}var d=Math.abs,f=String.prototype.toLowerCase,p=String.prototype.toUpperCase,h=String.prototype.replace,g=/e\+(\d)$/,b=/e-(\d)$/,m=/^(\d+)$/,y=/^(\d+)e/,w=/\.0$/,v=/\.0*e/,j=/(\..*[^0])0*e/;function O(e){var t,r,n=parseFloat(e.arg);if(!isFinite(n)){if(!o(e.arg))throw new Error("invalid floating-point number. Value: "+r);n=e.arg}switch(e.specifier){case"e":case"E":r=n.toExponential(e.precision);break;case"f":case"F":r=n.toFixed(e.precision);break;case"g":case"G":d(n)<1e-4?((t=e.precision)>0&&(t-=1),r=n.toExponential(t)):r=n.toPrecision(e.precision),e.alternate||(r=h.call(r,j,"$1e"),r=h.call(r,v,"e"),r=h.call(r,w,""));break;default:throw new Error("invalid double notation. Value: "+e.specifier)}return r=h.call(r,g,"e+0$1"),r=h.call(r,b,"e-0$1"),e.alternate&&(r=h.call(r,m,"$1."),r=h.call(r,y,"$1.e")),n>=0&&e.sign&&(r=e.sign+r),r=e.specifier===p.call(e.specifier)?p.call(r):f.call(r)}function _(e){var t,r="";for(t=0;t<e;t++)r+=" ";return r}var M=String.fromCharCode,E=isNaN,T=Array.isArray;function S(e){var t={};return t.specifier=e.specifier,t.precision=void 0===e.precision?1:e.precision,t.width=e.width,t.flags=e.flags||"",t.mapping=e.mapping,t}function k(e){var t,r,n,i,o,a,u,l,d,f,p,h,g;if(!T(e))throw new TypeError("invalid argument. First argument must be an array. Value: `"+e+"`.");for(a="",u=1,l=0;l<e.length;l++)if(n=e[l],"string"==typeof n)a+=n;else{if(t=void 0!==n.precision,!(n=S(n)).specifier)throw new TypeError("invalid argument. Token is missing `specifier` property. Index: `"+l+"`. Value: `"+n+"`.");for(n.mapping&&(u=n.mapping),r=n.flags,d=0;d<r.length;d++)switch(i=r.charAt(d)){case" ":n.sign=" ";break;case"+":n.sign="+";break;case"-":n.padRight=!0,n.padZeros=!1;break;case"0":n.padZeros=r.indexOf("-")<0;break;case"#":n.alternate=!0;break;default:throw new Error("invalid flag: "+i)}if("*"===n.width){if(n.width=parseInt(arguments[u],10),u+=1,E(n.width))throw new TypeError("the argument for * width at position "+u+" is not a number. Value: `"+n.width+"`.");n.width<0&&(n.padRight=!0,n.width=-n.width)}if(t&&"*"===n.precision){if(n.precision=parseInt(arguments[u],10),u+=1,E(n.precision))throw new TypeError("the argument for * precision at position "+u+" is not a number. Value: `"+n.precision+"`.");n.precision<0&&(n.precision=1,t=!1)}switch(n.arg=arguments[u],n.specifier){case"b":case"o":case"x":case"X":case"d":case"i":case"u":t&&(n.padZeros=!1),n.arg=c(n);break;case"s":n.maxWidth=t?n.precision:-1;break;case"c":if(!E(n.arg)){if((o=parseInt(n.arg,10))<0||o>127)throw new Error("invalid character code. Value: "+n.arg);n.arg=E(o)?String(n.arg):M(o)}break;case"e":case"E":case"f":case"F":case"g":case"G":t||(n.precision=6),n.arg=O(n);break;default:throw new Error("invalid specifier: "+n.specifier)}n.maxWidth>=0&&n.arg.length>n.maxWidth&&(n.arg=n.arg.substring(0,n.maxWidth)),n.padZeros?n.arg=s(n.arg,n.width||n.precision,n.padRight):n.width&&(n.arg=(f=n.arg,p=n.width,h=n.padRight,g=void 0,(g=p-f.length)<0?f:f=h?f+_(g):_(g)+f)),a+=n.arg||"",u+=1}return a}var V=/%(?:([1-9]\d*)\$)?([0 +\-#]*)(\*|\d+)?(?:(\.)(\*|\d+)?)?[hlL]?([%A-Za-z])/g;function x(e){var t={mapping:e[1]?parseInt(e[1],10):void 0,flags:e[2],width:e[3],precision:e[5],specifier:e[6]};return"."===e[4]&&void 0===e[5]&&(t.precision="1"),t}function W(e){var t,r,n,i;for(r=[],i=0,n=V.exec(e);n;)(t=e.slice(i,V.lastIndex-n[0].length)).length&&r.push(t),r.push(x(n)),i=V.lastIndex,n=V.exec(e);return(t=e.slice(i)).length&&r.push(t),r}function C(e){var t,r;if("string"!=typeof e)throw new TypeError(C("invalid argument. First argument must be a string. Value: `%s`.",e));for(t=[W(e)],r=1;r<arguments.length;r++)t.push(arguments[r]);return k.apply(null,t)}var N,I=Object.prototype,A=I.toString,z=I.__defineGetter__,H=I.__defineSetter__,J=I.__lookupGetter__,F=I.__lookupSetter__;N=function(){try{return n({},"x",{}),!0}catch(e){return!1}}()?i:function(e,t,r){var n,i,o,a;if("object"!=typeof e||null===e||"[object Array]"===A.call(e))throw new TypeError(C("invalid argument. First argument must be an object. Value: `%s`.",e));if("object"!=typeof r||null===r||"[object Array]"===A.call(r))throw new TypeError(C("invalid argument. Property descriptor must be an object. Value: `%s`.",r));if((i="value"in r)&&(J.call(e,t)||F.call(e,t)?(n=e.__proto__,e.__proto__=I,delete e[t],e[t]=r.value,e.__proto__=n):e[t]=r.value),o="get"in r,a="set"in r,i&&(o||a))throw new Error("invalid argument. Cannot specify one or more accessors and a value or writable attribute in the property descriptor.");return o&&z&&z.call(e,t,r.get),a&&H&&H.call(e,t,r.set),e};var R=N;function P(e,t,r){R(e,t,{configurable:!1,enumerable:!0,writable:!1,value:r})}function B(e,t,r){R(e,t,{configurable:!1,enumerable:!1,writable:!1,value:r})}function L(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var $=/./;function U(e){return"boolean"==typeof e}var q="function"==typeof Symbol&&"symbol"==typeof Symbol("foo");function G(){return q&&"symbol"==typeof Symbol.toStringTag}var X=Object.prototype.toString;var Z=Object.prototype.hasOwnProperty;function Y(e,t){return null!=e&&Z.call(e,t)}var D="function"==typeof Symbol?Symbol:void 0,K="function"==typeof D?D.toStringTag:"";var Q=G()?function(e){var t,r,n;if(null==e)return X.call(e);r=e[K],t=Y(e,K);try{e[K]=void 0}catch(t){return X.call(e)}return n=X.call(e),t?e[K]=r:delete e[K],n}:function(e){return X.call(e)},ee=Boolean,te=Boolean.prototype.toString;var re=G();function ne(e){return"object"==typeof e&&(e instanceof ee||(re?function(e){try{return te.call(e),!0}catch(e){return!1}}(e):"[object Boolean]"===Q(e)))}function ie(e){return U(e)||ne(e)}B(ie,"isPrimitive",U),B(ie,"isObject",ne);var oe="object"==typeof self?self:null,ae="object"==typeof window?window:null,se="object"==typeof global?global:null,ue="object"==typeof globalThis?globalThis:null;function le(e){if(arguments.length){if(!U(e))throw new TypeError(C("invalid argument. Must provide a boolean. Value: `%s`.",e));if(e)return new Function("return this;")()}if(ue)return ue;if(oe)return oe;if(ae)return ae;if(se)return se;throw new Error("unexpected error. Unable to resolve global object.")}var ce=le(),de=ce.document&&ce.document.childNodes,fe=Int8Array;function pe(){return/^\s*function\s*([^(]*)/i}var he,ge=/^\s*function\s*([^(]*)/i;B(pe,"REGEXP",ge),he=Array.isArray?Array.isArray:function(e){return"[object Array]"===Q(e)};var be=he;function me(e){return null!==e&&"object"==typeof e}var ye=function(e){if("function"!=typeof e)throw new TypeError(C("invalid argument. Must provide a function. Value: `%s`.",e));return function(t){var r,n;if(!be(t))return!1;if(0===(r=t.length))return!1;for(n=0;n<r;n++)if(!1===e(t[n]))return!1;return!0}}(me);function we(e){return me(e)&&(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))}function ve(e){var t,r,n;if(("Object"===(r=Q(e).slice(8,-1))||"Error"===r)&&e.constructor){if("string"==typeof(n=e.constructor).name)return n.name;if(t=ge.exec(n.toString()))return t[1]}return we(e)?"Buffer":r}B(me,"isObjectLikeArray",ye);var je="function"==typeof $||"object"==typeof fe||"function"==typeof de?function(e){return ve(e).toLowerCase()}:function(e){var t;return null===e?"null":"object"===(t=typeof e)?ve(e).toLowerCase():t};function Oe(e){return"function"===je(e)}var _e=Oe(Object.assign),Me=Object.assign;function Ee(e){return Object.keys(Object(e))}var Te,Se=void 0!==Object.keys;function ke(e){return"[object Arguments]"===Q(e)}Te=function(){return ke(arguments)}();var Ve=Te;function xe(e){return"string"==typeof e}var We=String.prototype.valueOf;var Ce=G();function Ne(e){return"object"==typeof e&&(e instanceof String||(Ce?function(e){try{return We.call(e),!0}catch(e){return!1}}(e):"[object String]"===Q(e)))}function Ie(e){return xe(e)||Ne(e)}function Ae(e){return"number"==typeof e}B(Ie,"isPrimitive",xe),B(Ie,"isObject",Ne);var ze=Number,He=ze.prototype.toString;var Je=G();function Fe(e){return"object"==typeof e&&(e instanceof ze||(Je?function(e){try{return He.call(e),!0}catch(e){return!1}}(e):"[object Number]"===Q(e)))}function Re(e){return Ae(e)||Fe(e)}function Pe(e){return e!=e}function Be(e){return Ae(e)&&Pe(e)}function Le(e){return Fe(e)&&Pe(e.valueOf())}function $e(e){return Be(e)||Le(e)}B(Re,"isPrimitive",Ae),B(Re,"isObject",Fe),B($e,"isPrimitive",Be),B($e,"isObject",Le);var Ue=Number.POSITIVE_INFINITY,qe=ze.NEGATIVE_INFINITY,Ge=Math.floor;function Xe(e){return Ge(e)===e}function Ze(e){return e<Ue&&e>qe&&Xe(e)}function Ye(e){return Ae(e)&&Ze(e)}function De(e){return Fe(e)&&Ze(e.valueOf())}function Ke(e){return Ye(e)||De(e)}B(Ke,"isPrimitive",Ye),B(Ke,"isObject",De);var Qe=Object.prototype.propertyIsEnumerable;var et=!Qe.call("beep","0");function tt(e,t){var r;return null!=e&&(!(r=Qe.call(e,t))&&et&&Ie(e)?!Be(t=+t)&&Ye(t)&&t>=0&&t<e.length:r)}var rt;rt=Ve?ke:function(e){return null!==e&&"object"==typeof e&&!be(e)&&"number"==typeof e.length&&Xe(e.length)&&e.length>=0&&e.length<=4294967295&&Y(e,"callee")&&!tt(e,"callee")};var nt=rt,it=Array.prototype.slice;var ot=tt((function(){}),"prototype"),at=!tt({toString:null},"toString"),st=9007199254740991;function ut(e){return"object"==typeof e&&null!==e&&"number"==typeof e.length&&Xe(e.length)&&e.length>=0&&e.length<=st}function lt(e,t,r){var n,i;if(!ut(e)&&!xe(e))throw new TypeError(C("invalid argument. First argument must be an array-like object. Value: `%s`.",e));if(0===(n=e.length))return-1;if(3===arguments.length){if(!Ye(r))throw new TypeError(C("invalid argument. Third argument must be an integer. Value: `%s`.",r));if(r>=0){if(r>=n)return-1;i=r}else(i=n+r)<0&&(i=0)}else i=0;if($e(t)){for(;i<n;i++)if($e(e[i]))return i}else for(;i<n;i++)if(e[i]===t)return i;return-1}function ct(e){return e.constructor&&e.constructor.prototype===e}var dt=["console","external","frame","frameElement","frames","innerHeight","innerWidth","outerHeight","outerWidth","pageXOffset","pageYOffset","parent","scrollLeft","scrollTop","scrollX","scrollY","self","webkitIndexedDB","webkitStorageInfo","window"],ft="undefined"==typeof window?void 0:window;var pt=function(){var e;if("undefined"===je(ft))return!1;for(e in ft)try{-1===lt(dt,e)&&Y(ft,e)&&null!==ft[e]&&"object"===je(ft[e])&&ct(ft[e])}catch(e){return!0}return!1}(),ht="undefined"!=typeof window;var gt,bt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];gt=Se?function(){return 2!==(Ee(arguments)||"").length}(1,2)?function(e){return nt(e)?Ee(it.call(e)):Ee(e)}:Ee:function(e){var t,r,n,i,o,a,s;if(i=[],nt(e)){for(s=0;s<e.length;s++)i.push(s.toString());return i}if("string"==typeof e){if(e.length>0&&!Y(e,"0"))for(s=0;s<e.length;s++)i.push(s.toString())}else{if(!1==(n="function"==typeof e)&&!me(e))return i;r=ot&&n}for(o in e)r&&"prototype"===o||!Y(e,o)||i.push(String(o));if(at)for(t=function(e){if(!1===ht&&!pt)return ct(e);try{return ct(e)}catch(e){return!1}}(e),s=0;s<bt.length;s++)a=bt[s],t&&"constructor"===a||!Y(e,a)||i.push(String(a));return i};var mt,yt=gt,wt=void 0!==Object.getOwnPropertySymbols,vt=Object,jt=vt.getOwnPropertySymbols;mt=wt?function(e){return jt(vt(e))}:function(){return[]};var Ot,_t=mt;function Mt(e){var t,r,n;for(t=yt(e),r=_t(e),n=0;n<r.length;n++)tt(e,r[n])&&t.push(r[n]);return t}Ot=_e?Me:function(e){var t,r,n,i,o,a,s;if(null==e)throw new TypeError(C("invalid argument. First argument must be a non-null object. Value: `%s`.",e));for(o=vt(e),a=1;a<arguments.length;a++)if(null!=(t=arguments[a]))for(i=(r=Mt(vt(t))).length,s=0;s<i;s++)o[n=r[s]]=t[n];return o};var Et=Ot;function Tt(e){var t=typeof e;return null===e||"object"!==t&&"function"!==t?new TypeError(C("invalid argument. A provided constructor must be either an object (except null) or a function. Value: `%s`.",e)):null}var St=Object.create;function kt(){}var Vt="function"==typeof St?St:function(e){return kt.prototype=e,new kt};function xt(e,t){var r=Tt(e);if(r)throw r;if(r=Tt(t))throw r;if(void 0===t.prototype)throw new TypeError(C("invalid argument. Second argument must have a prototype from which another object can inherit. Value: `%s`.",t.prototype));return e.prototype=Vt(t.prototype),R(e.prototype,"constructor",{configurable:!0,enumerable:!1,writable:!0,value:e}),e}function Wt(e,t,r){R(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}var Ct=t;function Nt(e){var t,r;for(t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);Ct.nextTick((function(){e.apply(null,t)}))}var It={objectMode:!1,allowHalfOpen:!1,readableObjectMode:!1};var At,zt=Object.getPrototypeOf;At=Oe(Object.getPrototypeOf)?zt:function(e){var t=function(e){return e.__proto__}(e);return t||null===t?t:"[object Function]"===Q(e.constructor)?e.constructor.prototype:e instanceof Object?Object.prototype:null};var Ht=At;function Jt(e){return null==e?null:(e=vt(e),Ht(e))}var Ft=Object.prototype;function Rt(e){var t;return!!function(e){return"object"==typeof e&&null!==e&&!be(e)}(e)&&(!(t=Jt(e))||!Y(e,"constructor")&&Y(t,"constructor")&&Oe(t.constructor)&&"[object Function]"===Q(t.constructor)&&Y(t,"isPrototypeOf")&&Oe(t.isPrototypeOf)&&(t===Ft||function(e){var t;for(t in e)if(!Y(e,t))return!1;return!0}(e)))}function Pt(e){return Ae(e)&&e>=0}function Bt(e){return Fe(e)&&e.valueOf()>=0}function Lt(e){return Pt(e)||Bt(e)}B(Lt,"isPrimitive",Pt),B(Lt,"isObject",Bt);var $t=L(Object.freeze({__proto__:null,default:()=>()=>{}})),Ut=$t("inspect-stream"),qt=e.Transform;function Gt(e,t){var r,n,i;if(!(this instanceof Gt))return arguments.length>1?new Gt(e,t):new Gt(e);if(n=Et({},It),arguments.length>1){if(r=t,i=function(e,t){return Rt(t)?Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"readableObjectMode")&&(e.readableObjectMode=t.readableObjectMode,!U(e.readableObjectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","readableObjectMode",e.readableObjectMode)):Y(t,"allowHalfOpen")&&(e.allowHalfOpen=t.allowHalfOpen,!U(e.allowHalfOpen))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","allowHalfOpen",e.allowHalfOpen)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(n,e),i)throw i}else r=e;if(!Oe(r))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",r));return n.writableObjectMode=!0,Ut("Creating a transform stream configured with the following options: %s.",JSON.stringify(n)),qt.call(this,n),Wt(this,"_destroyed",!1),Wt(this,"_idx",-1),B(this,"_inspect",r),this}xt(Gt,qt),B(Gt.prototype,"_transform",(function(e,t,r){this._idx+=1,Ut("Received a new chunk. Chunk: %s. Encoding: %s. Index: %d.",e.toString(),t,this._idx),this._inspect.call(null,e,this._idx),this.push(e),r()})),B(Gt.prototype,"_flush",(function(e){Ut("Flushing the stream..."),e()})),B(Gt.prototype,"destroy",(function(e){var t;return this._destroyed?(Ut("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(Ut("Stream was destroyed due to an error. Error: %s.",JSON.stringify(e)),t.emit("error",e));Ut("Closing the stream..."),t.emit("close")})),this)})),B(Gt,"objectMode",(function(e,t){var r,n;if(arguments.length>1){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));r=Et({},e),n=t}else r={},n=e;return r.objectMode=!0,new Gt(r,n)})),B(Gt,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e){return new Gt(t,e)}}));var Xt="debug-stream",Zt=$t(Xt),Yt={objectMode:!1,allowHalfOpen:!1,readableObjectMode:!1,name:""};function Dt(e,t){return Rt(t)?Y(t,"name")&&(e.name=t.name,!xe(e.name))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","name",e.name)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"readableObjectMode")&&(e.readableObjectMode=t.readableObjectMode,!U(e.readableObjectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","readableObjectMode",e.readableObjectMode)):Y(t,"allowHalfOpen")&&(e.allowHalfOpen=t.allowHalfOpen,!U(e.allowHalfOpen))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","allowHalfOpen",e.allowHalfOpen)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}var Kt=$t;function Qt(e,t){var r,n,i,o,a;if(!(this instanceof Qt))return arguments.length>1?new Qt(e,t):1===arguments.length?new Qt(e):new Qt;if(r=Et({},Yt),arguments.length>1){if(!Oe(t))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",t));a=t,o=Dt(r,e)}else arguments.length&&(Oe(e)?a=e:o=Dt(r,e));if(o)throw o;return n=r.name?Xt+":"+r.name:Xt,i=Kt(n),Zt("Creating a transform stream configured with the following options: %s.",JSON.stringify(r)),Gt.call(this,r,(function(e,t){if(a)return Zt("Received a new chunk. Chunk: %s. Index: %d.",e.toString(),t),a(i,e,t);we(e)&&(e=e.toString());e=JSON.stringify(e),Zt("Received a new chunk. Chunk: %s. Index: %d.",e,t),i("Chunk: %s. Index: %d.",e,t)})),this}xt(Qt,Gt),B(Qt,"objectMode",(function(e,t){var r,n;if(arguments.length>1){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));if(r=Et({},e),n=t,!Oe(t))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",t))}else if(arguments.length)if(Oe(e))r={},n=e;else{if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));r=Et({},e)}else r={};return r.objectMode=!0,void 0===n?new Qt(r):new Qt(r,n)})),B(Qt,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e,r){if(t.name=e,arguments.length>1)return new Qt(t,r);return new Qt(t)}}));var er={objectMode:!1,decodeStrings:!0,defaultEncoding:"utf8"};var tr=$t("inspect-stream-sink"),rr=e.Writable;function nr(e,t){var r,n,i;if(!(this instanceof nr))return arguments.length>1?new nr(e,t):new nr(e);if(n=Et({},er),arguments.length>1){if(r=t,i=function(e,t){return Rt(t)?Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"decodeStrings")&&(e.decodeStrings=t.decodeStrings,!U(e.decodeStrings))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","decodeStrings",e.decodeStrings)):Y(t,"defaultEncoding")&&(e.defaultEncoding=t.defaultEncoding,!xe(e.defaultEncoding))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","defaultEncoding",e.defaultEncoding)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(n,e),i)throw i}else r=e;if(!Oe(r))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",r));return tr("Creating a writable stream configured with the following options: %s.",JSON.stringify(n)),rr.call(this,n),Wt(this,"_destroyed",!1),Wt(this,"_idx",-1),B(this,"_inspect",r),this}xt(nr,rr),B(nr.prototype,"_write",(function(e,t,r){if(this._idx+=1,tr("Received a new chunk. Chunk: %s. Encoding: %s. Index: %d.",e.toString(),t,this._idx),this._inspect.call(null,e,this._idx),this._destroyed)return Nt(r);r()})),B(nr.prototype,"destroy",(function(e){var t;return this._destroyed?(tr("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(tr("Stream was destroyed due to an error. Error: %s.",JSON.stringify(e)),t.emit("error",e));tr("Closing the stream..."),t.emit("close")})),this)})),B(nr,"objectMode",(function(e,t){var r,n;if(arguments.length>1){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));r=Et({},e),n=t}else r={},n=e;return r.objectMode=!0,new nr(r,n)})),B(nr,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e){return new nr(t,e)}}));var ir="debug-stream-sink",or=$t(ir),ar={objectMode:!1,decodeStrings:!0,defaultEncoding:"utf8",name:""};function sr(e,t){return Rt(t)?Y(t,"name")&&(e.name=t.name,!xe(e.name))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","name",e.name)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"decodeStrings")&&(e.decodeStrings=t.decodeStrings,!U(e.decodeStrings))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","decodeStrings",e.decodeStrings)):Y(t,"defaultEncoding")&&(e.defaultEncoding=t.defaultEncoding,!xe(e.defaultEncoding))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","defaultEncoding",e.defaultEncoding)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}var ur=$t;function lr(e,t){var r,n,i,o,a;if(!(this instanceof lr))return arguments.length>1?new lr(e,t):1===arguments.length?new lr(e):new lr;if(r=Et({},ar),arguments.length>1){if(!Oe(t))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",t));a=t,o=sr(r,e)}else arguments.length&&(Oe(e)?a=e:o=sr(r,e));if(o)throw o;return n=r.name?ir+":"+r.name:ir,i=ur(n),or("Creating a writable stream configured with the following options: %s.",JSON.stringify(r)),nr.call(this,r,(function(e,t){if(a)return or("Received a new chunk. Chunk: %s. Index: %d.",e.toString(),t),a(i,e,t);we(e)&&(e=e.toString());e=JSON.stringify(e),or("Received a new chunk. Chunk: %s. Index: %d.",e,t),i("Chunk: %s. Index: %d.",e,t)})),this}function cr(e){if("object"!=typeof e||null===e)return!1;if(e instanceof Error)return!0;for(;e;){if("[object Error]"===Q(e))return!0;e=Jt(e)}return!1}xt(lr,nr),B(lr,"objectMode",(function(e,t){var r,n;if(arguments.length>1){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));if(r=Et({},e),n=t,!Oe(t))throw new TypeError(C("invalid argument. Callback argument must be a function. Value: `%s`.",t))}else if(arguments.length)if(Oe(e))r={},n=e;else{if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));r=Et({},e)}else r={};return r.objectMode=!0,void 0===n?new lr(r):new lr(r,n)})),B(lr,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e,r){if(t.name=e,arguments.length>1)return new lr(t,r);return new lr(t)}}));var dr={objectMode:!1};var fr=$t("empty-stream"),pr=e.Readable;function hr(e){var t,r;if(!(this instanceof hr))return arguments.length>0?new hr(e):new hr;if(t=Et({},dr),arguments.length>0&&(r=function(e,t){return Rt(t)?Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(t,e),r))throw r;return fr("Creating a readable stream configured with the following options: %s.",JSON.stringify(t)),pr.call(this,t),Wt(this,"_destroyed",!1),this}xt(hr,pr),B(hr.prototype,"_read",(function(){this.push(null)})),B(hr.prototype,"destroy",(function(e){var t;return this._destroyed?(fr("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(fr("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));fr("Closing the stream..."),t.emit("close")})),this)})),B(hr,"objectMode",(function(){return new hr({objectMode:!0})})),B(hr,"factory",(function(e){var t;if(arguments.length>0){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(){return new hr(t)}}));var gr="function"==typeof Buffer?Buffer:null;var br,mr=r.Buffer;br=function(){var e,t;if("function"!=typeof gr)return!1;try{e=we(t="function"==typeof gr.from?gr.from([1,2,3,4]):new gr([1,2,3,4]))&&1===t[0]&&2===t[1]&&3===t[2]&&4===t[3]}catch(t){e=!1}return e}()?mr:function(){throw new Error("not implemented")};var yr,wr=br;yr=Oe(wr.from)?function(e,t){if(!xe(e))throw new TypeError(C("invalid argument. First argument must be a string. Value: `%s`.",e));if(arguments.length>1){if(!xe(t))throw new TypeError(C("invalid argument. Second argument must be a string. Value: `%s`.",t));return wr.from(e,t)}return wr.from(e,"utf8")}:function(e,t){if(!xe(e))throw new TypeError(C("invalid argument. First argument must be a string. Value: `%s`.",e));if(arguments.length>1){if(!xe(t))throw new TypeError(C("invalid argument. Second argument must be a string. Value: `%s`.",t));return new wr(e,t)}return new wr(e,"utf8")};var vr=yr,jr={objectMode:!1,encoding:null,sep:"\n",dir:1};var Or=$t("from-array-stream"),_r=e.Readable;function Mr(e,t){var r,n;if(!(this instanceof Mr))return arguments.length>1?new Mr(e,t):new Mr(e);if(!ut(e))throw new TypeError(C("invalid argument. First argument must be an array-like object. Value: `%s`.",e));if(r=Et({},jr),arguments.length>1&&(n=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding)&&null!==e.encoding)?new TypeError(C("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"serialize")&&(e.serialize=t.serialize,!Oe(e.serialize))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","serialize",e.serialize)):Y(t,"dir")&&(e.dir=t.dir,1!==e.dir&&-1!==e.dir)?new TypeError(C("invalid option. `%s` option must be either `1` or `-1`. Option: `%s`.","dir",e.dir)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(r,t),n))throw n;return Or("Creating a readable stream configured with the following options: %s.",JSON.stringify(r)),_r.call(this,r),Wt(this,"_destroyed",!1),B(this,"_objectMode",r.objectMode),B(this,"_sep",r.sep),B(this,"_serialize",r.serialize||JSON.stringify),B(this,"_src",e),B(this,"_stride",r.dir),Wt(this,"_i",0),Wt(this,"_idx",1===r.dir?0:e.length-1),this}xt(Mr,_r),B(Mr.prototype,"_read",(function(){var e,t,r;if(!this._destroyed)for(e=!0;e;){if(t=null,this._i+=1,this._i>this._src.length)return Or("Finished iteration."),this.push(null);r=this._src[this._idx],Or("Value: %s. Idx: %d. Iter: %d.",JSON.stringify(r),this._idx,this._i),this._idx+=this._stride,!1===this._objectMode&&("string"==typeof(r=this._serialize(r))?r=1===this._i?vr(r):vr(this._sep+r):we(r)?this._i>1&&(r=wr.concat([vr(this._sep),r])):t=new Error(C("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r))),t?this.emit("error",t):e=this.push(r)}})),B(Mr.prototype,"destroy",(function(e){var t;return this._destroyed?(Or("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(Or("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));Or("Closing the stream..."),t.emit("close")})),this)})),B(Mr,"objectMode",(function(e,t){var r;if(arguments.length>1){if(!Rt(r=t))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",r));r=Et({},t)}else r={};return r.objectMode=!0,new Mr(e,r)})),B(Mr,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e){return new Mr(e,t)}}));var Er={objectMode:!1,encoding:null,sep:"\n",iter:1e308,dir:1};function Tr(e){return Ye(e)&&e>=0}function Sr(e){return De(e)&&e.valueOf()>=0}function kr(e){return Tr(e)||Sr(e)}B(kr,"isPrimitive",Tr),B(kr,"isObject",Sr);var Vr=$t("from-circular-array-stream"),xr=e.Readable;function Wr(e,t){var r,n;if(!(this instanceof Wr))return arguments.length>1?new Wr(e,t):new Wr(e);if(!ut(e))throw new TypeError(C("invalid argument. First argument must be an array-like object. Value: `%s`.",e));if(r=Et({},Er),arguments.length>1&&(n=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding)&&null!==e.encoding)?new TypeError(C("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"serialize")&&(e.serialize=t.serialize,!Oe(e.serialize))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","serialize",e.serialize)):Y(t,"iter")&&(e.iter=t.iter,!Tr(e.iter))?new TypeError(C("invalid option. `%s` option must be a nonnegative integer. Option: `%s`.","iter",e.iter)):Y(t,"dir")&&(e.dir=t.dir,1!==e.dir&&-1!==e.dir)?new TypeError(C("invalid option. `%s` option must be either `1` or `-1`. Option: `%s`.","dir",e.dir)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(r,t),n))throw n;return Vr("Creating a readable stream configured with the following options: %s.",JSON.stringify(r)),xr.call(this,r),Wt(this,"_destroyed",!1),B(this,"_objectMode",r.objectMode),B(this,"_sep",r.sep),B(this,"_serialize",r.serialize||JSON.stringify),B(this,"_src",e),B(this,"_stride",r.dir),B(this,"_iter",r.iter),Wt(this,"_i",0),Wt(this,"_idx",1===r.dir?-1:e.length),this}xt(Wr,xr),B(Wr.prototype,"_read",(function(){var e,t,r;if(!this._destroyed)for(e=!0;e;){if(t=null,this._i+=1,this._i>this._iter||0===this._src.length)return Vr("Finished iteration."),this.push(null);this._idx+=this._stride,this._stride>0&&this._idx>=this._src.length?this._idx%=this._src.length:this._stride<0&&this._idx<0&&(this._idx+=this._src.length),r=this._src[this._idx],Vr("Value: %s. Idx: %d. Iter: %d.",JSON.stringify(r),this._idx,this._i),!1===this._objectMode&&("string"==typeof(r=this._serialize(r))?r=1===this._i?vr(r):vr(this._sep+r):we(r)?this._i>1&&(r=wr.concat([vr(this._sep),r])):t=new Error(C("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r))),t?this.emit("error",t):e=this.push(r)}})),B(Wr.prototype,"destroy",(function(e){var t;return this._destroyed?(Vr("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(Vr("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));Vr("Closing the stream..."),t.emit("close")})),this)})),B(Wr,"objectMode",(function(e,t){var r;if(arguments.length>1){if(!Rt(r=t))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",r));r=Et({},t)}else r={};return r.objectMode=!0,new Wr(e,r)})),B(Wr,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e){return new Wr(e,t)}}));var Cr="function"==typeof Uint8Array;function Nr(e){return Cr&&e instanceof Uint8Array||"[object Uint8Array]"===Q(e)}var Ir=Object.prototype.toString;var Ar=new Function("try {return this === global;} catch ( err ) {return false;}")(),zr=t,Hr=le(),Jr=/node|io\.js/;var Fr,Rr,Pr="object"==typeof global&&global===Hr&&Hr===Hr.global&&("[object global]"===Q(Hr)||"[object Object]"===Q(Hr))&&!0===Ar&&"object"==typeof zr&&"[object process]"===(Fr=zr,Ir.call(Fr))&&Rt(zr.versions)&&xe(zr.versions.node)&&(void 0===zr.release||Rt(zr.release)&&xe(zr.release.name)&&Jr.test(zr.release.name)),Br=t.versions.node,Lr=(Rr=Pr?Br:null,Rr?parseInt(Rr.split(".")[0],10):-1),$r=Oe(wr.from)&&Lr>=5,Ur="function"==typeof ArrayBuffer;function qr(e){return Ur&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Q(e)}var Gr="function"==typeof Uint8Array?Uint8Array:null;var Xr,Zr="function"==typeof Uint8Array?Uint8Array:void 0;Xr=function(){var e,t;if("function"!=typeof Gr)return!1;try{e=Nr(t=new Gr(t=[1,3.14,-3.14,256,257]))&&1===t[0]&&3===t[1]&&253===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?Zr:function(){throw new Error("not implemented")};var Yr=Xr;var Dr,Kr=Oe(wr.from)?function(e){if(!ut(e))throw new TypeError(C("invalid argument. Must provide an array-like object. Value: `%s`.",e));return wr.from(e)}:function(e){if(!ut(e))throw new TypeError(C("invalid argument. Must provide an array-like object. Value: `%s`.",e));return new wr(e)};Dr=$r?function(e,t,r){var n,i;if(!qr(e))throw new TypeError(C("invalid argument. First argument must be an ArrayBuffer. Value: `%s`.",e));if(arguments.length>1){if(!Tr(t))throw new TypeError(C("invalid argument. Second argument must be a nonnegative integer. Value: `%s`.",t));if(t>e.byteLength)throw new RangeError(C("invalid argument. Second argument must not exceed the number of bytes in the input ArrayBuffer. Value: `%s`.",t));if(n=t,arguments.length>2){if(!Tr(r))throw new TypeError(C("invalid argument. Last argument must be a nonnegative integer. Value: `%s`.",r));if(r>e.byteLength)throw new RangeError(C("invalid argument. Last argument must not exceed the number of bytes in the input ArrayBuffer. Value: `%s`.",r));i=r}else i=e.byteLength-n}else n=0,i=e.byteLength;return 0===i&&Lr<6?wr.from([]):wr.from(e,n,i)}:function(e,t,r){var n;if(!qr(e))throw new TypeError(C("invalid argument. First argument must be an ArrayBuffer. Value: `%s`.",e));if(arguments.length>1){if(!Tr(t))throw new TypeError(C("invalid argument. Second argument must be a nonnegative integer. Value: `%s`.",t));if(t>e.byteLength)throw new RangeError(C("invalid argument. Second argument must not exceed the number of bytes in the input ArrayBuffer. Value: `%s`.",t));if(arguments.length>2){if(!Tr(r))throw new TypeError(C("invalid argument. Last argument must be a nonnegative integer. Value: `%s`.",r));if(r>e.byteLength)throw new RangeError(C("invalid argument. Last argument must not exceed the number of bytes in the input ArrayBuffer. Value: `%s`.",r));n=r}else n=e.byteLength-t;return Kr(new Yr(e,t,n))}return Lr<3?Kr(new Yr(e)):0===e.byteLength?new wr([]):new wr(e)};var Qr=Dr,en={objectMode:!1,encoding:null,sep:"\n",iter:1e308};var tn=$t("from-constant-stream"),rn=e.Readable;function nn(e,t){var r,n;if(!(this instanceof nn))return arguments.length>1?new nn(e,t):new nn(e);if(r=Et({},en),arguments.length>1&&(n=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding)&&null!==e.encoding)?new TypeError(C("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"iter")&&(e.iter=t.iter,!Tr(e.iter))?new TypeError(C("invalid option. `%s` option must be a nonnegative integer. Option: `%s`.","iter",e.iter)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(r,t),n))throw n;if(!1===r.objectMode)if(xe(e))e=vr(e);else if(we(e));else{if(!Nr(e))throw new TypeError(C("invalid argument. In binary mode, a provided value must be a string, Buffer, or Uint8Array. Value: `%s`.",e));e=Qr(e.buffer,e.byteOffset,e.length)}return tn("Creating a readable stream configured with the following options: %s.",JSON.stringify(r)),rn.call(this,r),Wt(this,"_destroyed",!1),B(this,"_objectMode",r.objectMode),B(this,"_sep",vr(r.sep)),B(this,"_iter",r.iter),B(this,"_value",e),Wt(this,"_i",0),this}xt(nn,rn),B(nn.prototype,"_read",(function(){var e;if(!this._destroyed)for(e=!0;e;){if(this._i+=1,this._i>this._iter)return tn("Finished iteration."),this.push(null);tn("Value: %s. Iter: %d.",this._value,this._i),e=!1===this._objectMode&&this._i>1?this.push(wr.concat([this._sep,this._value])):this.push(this._value)}})),B(nn.prototype,"destroy",(function(e){var t;return this._destroyed?(tn("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(tn("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));tn("Closing the stream..."),t.emit("close")})),this)})),B(nn,"objectMode",(function(e,t){var r;if(arguments.length>1){if(!Rt(r=t))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",r));r=Et({},t)}else r={};return r.objectMode=!0,new nn(e,r)})),B(nn,"factory",(function(e,t){var r,n,i;if(0===(r=arguments.length))n={},i=!0;else if(1===r)null!==e&&"object"==typeof e&&(Y(e,"sep")||Y(e,"iter")||Y(e,"objectMode")||Y(e,"encoding")||Y(e,"highWaterMark"))?(n=Et({},e),i=!0):n={};else{if(!Rt(t))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t));n=Et({},t)}return i?function(e){return new nn(e,n)}:function(){return new nn(e,n)}}));var on={objectMode:!1,encoding:null,sep:"\n"};var an=$t("from-iterator-stream"),sn=e.Readable;function un(e,t){var r,n;if(!(this instanceof un))return arguments.length>1?new un(e,t):new un(e);if(!function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)&&Oe(e.next)}(e))throw new TypeError(C("invalid argument. First argument must be an iterator. Value: `%s`.",e));if(r=Et({},on),arguments.length>1&&(n=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding)&&null!==e.encoding)?new TypeError(C("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"serialize")&&(e.serialize=t.serialize,!Oe(e.serialize))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","serialize",e.serialize)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(r,t),n))throw n;return an("Creating a readable stream configured with the following options: %s.",JSON.stringify(r)),sn.call(this,r),Wt(this,"_destroyed",!1),B(this,"_objectMode",r.objectMode),B(this,"_sep",r.sep),B(this,"_serialize",r.serialize||JSON.stringify),B(this,"_iterator",e),Wt(this,"_i",0),this}xt(un,sn),B(un.prototype,"_read",(function(){var e,t,r;if(!this._destroyed)for(e=!0;e;){if(r=this._iterator.next(),this._i+=1,r.done)return Y(r,"value")&&(r=r.value,an("Value: %s. Iter: %d.",JSON.stringify(r),this._i),!1===this._objectMode&&("string"==typeof(r=this._serialize(r))?(r=1===this._i?vr(r):vr(this._sep+r),this.push(r)):we(r)?(this._i>1&&(r=wr.concat([vr(this._sep),r])),this.push(r)):(t=new Error(C("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r)),this.emit("error",t)))),an("Finished iteration."),this.push(null);if(r=r.value,an("Value: %s. Iter: %d.",JSON.stringify(r),this._i),!1===this._objectMode)if("string"==typeof(r=this._serialize(r)))r=1===this._i?vr(r):vr(this._sep+r);else{if(!we(r)){t=new Error(C("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r)),this.emit("error",t);continue}this._i>1&&(r=wr.concat([vr(this._sep),r]))}e=this.push(r)}})),B(un.prototype,"destroy",(function(e){var t;return this._destroyed?(an("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(an("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));an("Closing the stream..."),t.emit("close")})),this)})),B(un,"objectMode",(function(e,t){var r;if(arguments.length>1){if(!Rt(r=t))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",r));r=Et({},t)}else r={};return r.objectMode=!0,new un(e,r)})),B(un,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e){return new un(e,t)}}));var ln={objectMode:!1,encoding:null,sep:"\n"};var cn=$t("from-strided-array-stream"),dn=e.Readable;function fn(e,t,r,n,i){var o,a,s;if(!(this instanceof fn))return arguments.length>4?new fn(e,t,r,n,i):new fn(e,t,r,n);if(!Tr(e))throw new TypeError(C("invalid argument. First argument must be a nonnegative integer. Value: `%s`.",e));if(!ut(t))throw new TypeError(C("invalid argument. Second argument must be an array-like object. Value: `%s`.",t));if(!Ye(r))throw new TypeError(C("invalid argument. Third argument must be an integer. Value: `%s`.",r));if(!Tr(n))throw new TypeError(C("invalid argument. Fourth argument must be a nonnegative integer. Value: `%s`.",n));if(e>0&&(s=n+(e-1)*r,n>=t.length||s<0||s>=t.length))throw new RangeError("invalid arguments. Strided array parameters are incompatible with the provided array-like object. Linear index exceeds array bounds.");if(o=Et({},ln),arguments.length>4&&(a=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding)&&null!==e.encoding)?new TypeError(C("invalid option. `%s` option must be a string or null. Option: `%s`.","encoding",e.encoding)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"serialize")&&(e.serialize=t.serialize,!Oe(e.serialize))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","serialize",e.serialize)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(o,i),a))throw a;return cn("Creating a readable stream configured with the following options: %s.",JSON.stringify(o)),dn.call(this,o),Wt(this,"_destroyed",!1),B(this,"_objectMode",o.objectMode),B(this,"_sep",o.sep),B(this,"_serialize",o.serialize||JSON.stringify),B(this,"_buffer",t),B(this,"_N",e),B(this,"_stride",r),B(this,"_offset",n),Wt(this,"_idx",n),Wt(this,"_i",0),this}xt(fn,dn),B(fn.prototype,"_read",(function(){var e,t,r;if(!this._destroyed)for(e=!0;e;){if(t=null,this._i+=1,this._i>this._N)return cn("Finished iteration."),this.push(null);r=this._buffer[this._idx],cn("Value: %s. Idx: %d. Iter: %d.",JSON.stringify(r),this._idx,this._i),this._idx+=this._stride,!1===this._objectMode&&("string"==typeof(r=this._serialize(r))?r=1===this._i?vr(r):vr(this._sep+r):we(r)?this._i>1&&(r=wr.concat([vr(this._sep),r])):t=new Error(C("invalid operation. Serialization function must return a string or Buffer. Value: `%s`.",r))),t?this.emit("error",t):e=this.push(r)}})),B(fn.prototype,"destroy",(function(e){var t;return this._destroyed?(cn("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(cn("Stream was destroyed due to an error. Error: %s.",cr(e)?e.message:JSON.stringify(e)),t.emit("error",e));cn("Closing the stream..."),t.emit("close")})),this)})),B(fn,"objectMode",(function(e,t,r,n,i){var o;if(arguments.length>4){if(!Rt(o=i))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",o));o=Et({},i)}else o={};return o.objectMode=!0,new fn(e,t,r,n,o)})),B(fn,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e,r,n,i){return new fn(e,r,n,i,t)}}));var pn=$t("join-stream"),hn=e.Transform;function gn(e){var t,r;if(!(this instanceof gn))return arguments.length?new gn(e):new gn;if(t={objectMode:!1,encoding:null,allowHalfOpen:!1,readableObjectMode:!1,sep:"\n"},arguments.length&&(r=function(e,t){return Rt(t)?Y(t,"sep")&&(e.sep=t.sep,!xe(e.sep))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","sep",e.sep)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"readableObjectMode")&&(e.readableObjectMode=t.readableObjectMode,!U(e.readableObjectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","readableObjectMode",e.readableObjectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","encoding",e.encoding)):Y(t,"allowHalfOpen")&&(e.allowHalfOpen=t.allowHalfOpen,!U(e.allowHalfOpen))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","allowHalfOpen",e.allowHalfOpen)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(t,e),r))throw r;return t.writableObjectMode=!0,t.decodeStrings=!1,pn("Creating a transform stream configured with the following options: %s.",JSON.stringify(t)),hn.call(this,t),Wt(this,"_destroyed",!1),B(this,"_encoding",null===t.encoding?"utf8":t.encoding),"utf8"!==this._encoding&&(t.sep=vr(t.sep,this._encoding)),B(this,"_sep",t.sep),Wt(this,"_init",!1),Wt(this,"_idx",-1),this}xt(gn,hn),B(gn.prototype,"_transform",(function(e,t,r){var n;this._idx+=1,pn("Received a new chunk. Chunk: %s. Encoding: %s. Index: %d.",e.toString(),t,this._idx),"utf8"===this._encoding?this._init?e=this._sep+e:this._init=!0:this._init?(e=new wr(e,t),n=this._sep.length+e.length,e=(e=wr.concat([this._sep,e],n)).toString(this._encoding)):this._init=!0,this.push(e,this._encoding),r()})),B(gn.prototype,"_flush",(function(e){pn("Flushing the stream..."),e()})),B(gn.prototype,"destroy",(function(e){var t;return this._destroyed?(pn("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(pn("Stream was destroyed due to an error. Error: %s.",JSON.stringify(e)),t.emit("error",e));pn("Closing the stream..."),t.emit("close")})),this)})),B(gn,"objectMode",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return t.objectMode=!0,new gn(t)})),B(gn,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(){return new gn(t)}}));var bn={objectMode:!1,encoding:null,allowHalfOpen:!1,writableObjectMode:!1,sep:null},mn=RegExp.prototype.exec;var yn=G();function wn(e){return"object"==typeof e&&(e instanceof RegExp||(yn?function(e){try{return mn.call(e),!0}catch(e){return!1}}(e):"[object RegExp]"===Q(e)))}var vn=$t("split-stream");function jn(e,t){return"utf8"===t||"buffer"===t?e:(e=vr(e),t?e.toString(t):e.toString())}var On=e.Transform,_n=/\r?\n/;function Mn(e){var t,r;if(!(this instanceof Mn))return arguments.length?new Mn(e):new Mn;if(t=Et({},bn),arguments.length&&(r=function(e,t){return Rt(t)?!Y(t,"sep")||(e.sep=t.sep,xe(e.sep)||wn(e.sep))?Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"writableObjectMode")&&(e.writableObjectMode=t.writableObjectMode,!U(e.writableObjectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","writableObjectMode",e.writableObjectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","encoding",e.encoding)):Y(t,"allowHalfOpen")&&(e.allowHalfOpen=t.allowHalfOpen,!U(e.allowHalfOpen))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","allowHalfOpen",e.allowHalfOpen)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):null:new TypeError(C("invalid option. `%s` option must be either a string or a regular expression. Option: `%s`.","sep",e.sep)):new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}(t,e),r))throw r;return t.readableObjectMode=!0,t.decodeStrings=!1,vn("Creating a transform stream configured with the following options: %s.",JSON.stringify(t)),On.call(this,t),B(this,"_sep",null===t.sep?_n:t.sep),Wt(this,"_destroyed",!1),B(this,"_encoding",t.encoding),Wt(this,"_buffer",""),Wt(this,"_idx",-1),this}xt(Mn,On),B(Mn.prototype,"_transform",(function(e,t,r){var n,i,o,a;if(this._idx+=1,vn("Received a new chunk. Chunk: %s. Encoding: %s. Index: %d.",e.toString(),t,this._idx),"buffer"===t?e=e.toString():"utf8"!==t&&(e=(e=new wr(e,t)).toString("utf8")),n=e.split(this._sep),vn("Splits: %s. Index: %d.",JSON.stringify(n),this._idx),o=n.length-1,vn("%s splits. Index: %d.",o,this._idx),0===o)vn("No splits. Index: %d.",this._idx),this._buffer+=n[o];else{for(vn("Processing splits. Index: %d.",this._index),i=jn(i=this._buffer+n[0],t),vn("Split %d: %s. Index: %d.",0,i.toString(),this._idx),this.push(i,t),a=1;a<o;a++)i=jn(n[a],t),vn("Split %d: %s. Index: %d.",a,i.toString(),this._idx),this.push(i,t);vn("Remaining split: %s.",n[o].toString()),this._buffer=n[o]}r()})),B(Mn.prototype,"_flush",(function(e){var t=this._buffer;t&&(vn("Processing final split..."),t=jn(t,this._encoding),this.push(t,this._encoding)),vn("Flushing the stream..."),e()})),B(Mn.prototype,"destroy",(function(e){var t;return this._destroyed?(vn("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(vn("Stream was destroyed due to an error. Error: %s.",JSON.stringify(e)),t.emit("error",e));vn("Closing the stream..."),t.emit("close")})),this)})),B(Mn,"objectMode",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return t.objectMode=!0,new Mn(t)})),B(Mn,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(){return new Mn(t)}}));var En=t.stderr,Tn=t.stdin,Sn=t.stdout,kn={objectMode:!1,encoding:null,allowHalfOpen:!1,decodeStrings:!0};function Vn(e,t){return Rt(t)?Y(t,"transform")&&(e.transform=t.transform,!Oe(e.transform))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","transform",e.transform)):Y(t,"flush")&&(e.flush=t.flush,!Oe(e.flush))?new TypeError(C("invalid option. `%s` option must be a function. Option: `%s`.","flush",e.flush)):Y(t,"objectMode")&&(e.objectMode=t.objectMode,!U(e.objectMode))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","objectMode",e.objectMode)):Y(t,"encoding")&&(e.encoding=t.encoding,!xe(e.encoding))?new TypeError(C("invalid option. `%s` option must be a string. Option: `%s`.","encoding",e.encoding)):Y(t,"allowHalfOpen")&&(e.allowHalfOpen=t.allowHalfOpen,!U(e.allowHalfOpen))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","allowHalfOpen",e.allowHalfOpen)):Y(t,"highWaterMark")&&(e.highWaterMark=t.highWaterMark,!Pt(e.highWaterMark))?new TypeError(C("invalid option. `%s` option must be a nonnegative number. Option: `%s`.","highWaterMark",e.highWaterMark)):Y(t,"decodeStrings")&&(e.decodeStrings=t.decodeStrings,!U(e.decodeStrings))?new TypeError(C("invalid option. `%s` option must be a boolean. Option: `%s`.","decodeStrings",e.decodeStrings)):null:new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",t))}var xn=$t("transform-stream:destroy");function Wn(e){var t;return this._destroyed?(xn("Attempted to destroy an already destroyed stream."),this):(t=this,this._destroyed=!0,Nt((function(){e&&(xn("Stream was destroyed due to an error. Error: %s.",JSON.stringify(e)),t.emit("error",e));xn("Closing the stream..."),t.emit("close")})),this)}var Cn=$t("transform-stream:transform");function Nn(e,t,r){Cn("Received a new chunk. Chunk: %s. Encoding: %s.",e.toString(),t),r(null,e)}var In=$t,An=e.Transform,zn=In("transform-stream:main");function Hn(e){var t,r;if(!(this instanceof Hn))return arguments.length?new Hn(e):new Hn;if(t=Et({},kn),arguments.length&&(r=Vn(t,e)))throw r;return zn("Creating a transform stream configured with the following options: %s.",JSON.stringify(t)),An.call(this,t),this._destroyed=!1,t.transform?this._transform=t.transform:this._transform=Nn,t.flush&&(this._flush=t.flush),this}xt(Hn,An),Hn.prototype.destroy=Wn;var Jn=$t,Fn=e.Transform,Rn=Jn("transform-stream:ctor");B(Hn,"objectMode",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return t.objectMode=!0,new Hn(t)})),B(Hn,"factory",(function(e){var t;if(arguments.length){if(!Rt(e))throw new TypeError(C("invalid argument. Options argument must be an object. Value: `%s`.",e));t=Et({},e)}else t={};return function(e,r){t.transform=e,arguments.length>1?t.flush=r:delete t.flush;return new Hn(t)}})),B(Hn,"ctor",(function(e){var t,r,n;if(r=Et({},kn),arguments.length&&(n=Vn(r,e)))throw n;function i(e){var t,n;if(!(this instanceof i))return arguments.length?new i(e):new i;if(t=Et({},r),arguments.length&&(n=Vn(t,e)))throw n;return Rn("Creating a transform stream configured with the following options: %s.",JSON.stringify(t)),Fn.call(this,t),this._destroyed=!1,this}return t=r.transform?r.transform:Nn,xt(i,Fn),i.prototype._transform=t,r.flush&&(i.prototype._flush=r.flush),i.prototype.destroy=Wn,i}));var Pn={};return P(Pn,"debugStream",Qt),P(Pn,"debugSinkStream",lr),P(Pn,"emptyStream",hr),P(Pn,"arrayStream",Mr),P(Pn,"circularArrayStream",Wr),P(Pn,"constantStream",nn),P(Pn,"iteratorStream",un),P(Pn,"stridedArrayStream",fn),P(Pn,"inspectStream",Gt),P(Pn,"inspectSinkStream",nr),P(Pn,"joinStream",gn),P(Pn,"splitStream",Mn),P(Pn,"stderr",En),P(Pn,"stdin",Tn),P(Pn,"stdout",Sn),P(Pn,"transformStream",Hn),Pn}));
//# sourceMappingURL=index.js.map
